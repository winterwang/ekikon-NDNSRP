<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Mining the National Diet and Nutrition Survey (NDNS RP) data</title>
    <meta charset="utf-8" />
    <meta name="author" content="王　超辰 | Chaochen Wang" />
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
    <script src="libs/jquery-1.12.4/jquery.min.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.8/datatables.js"></script>
    <link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Mining the National Diet and Nutrition Survey (NDNS RP) data
## Where, when, what you eat.
### 王　超辰 | Chaochen Wang
### 2019-09-17 18:00~19:30 <br> <span class="citation">@AMU</span>・疫学懇話会

---




class: middle

# Outline of today's talk 

--
### Correspondence analyses:


- Relationship between **food consumed** and **eating location** for UK adolescents


- Relationship between **food consumed** and **eating time** for UK adults according to their diabetes status 

&lt;!-- -- --&gt;

&lt;!-- ### Multilevel Latent Class Analysis: --&gt;

&lt;!-- - Relationship between **carbohydrate consumption** and **eating time** for UK adults.  --&gt;

---
class: middle

## Some intuition about correspondence analysis  (CA)

- CA is a method for investigating the relationship in a **two-dimensional contingency table**.

- It takes a large table, and turns it into a seemingly easy-to-read visualization.


---
class: middle

## Analysis of a contingency table

- The frequency of consumption of three healthy food groups at each location in the NDNS RP data among teenagers (age: 11~19 years):

&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Others &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Home &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; School_work &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Sum &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Brown Bread &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 95 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 613 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 201 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 909 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Fruit &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 455 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2595 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 839 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3889 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Veg not raw &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 698 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6122 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 376 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7196 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Sum &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1248 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9330 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1416 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11994 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
class: middle 

## Usually, we will conduct a `\(\chi^2\)` test. 

&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Others &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Home &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; School_work &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Sum &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Brown Bread &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 95 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 613 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 201 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 909 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Fruit &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 455 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2595 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 839 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3889 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Veg not raw &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 698 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6122 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 376 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7196 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Sum &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1248 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9330 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1416 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11994 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


$$
\chi^2 = \sum\frac{(\text{Observed} - \text{Expected})^2}{\text{Expected}} \sim \chi^2_{(m -1)\times(n-1)}
$$

--
To look for evidence against the null hypothesis that **there is no difference across the columns or rows**.

---
class: middle
## Hypothesis of independence

The null hypothesis of no difference across the columns or rows is also called: **Hypothesis of independence, or Homogeneity assumption.**


```r
chisq.test(freqtab)
```

```
## 
## 	Pearson's Chi-squared test
## 
## data:  freqtab
## X-squared = 792.56, df = 4, p-value &lt; 2.2e-16
```


We conclude that **there is dependency between the columns (food groups) and the rows (locations)**. 

---
class: middle

## But what exactly does this dependency mean?


&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Others &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Home &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; School_work &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Sum &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Brown Bread &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 95 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 613 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 201 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 909 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Fruit &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 455 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2595 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 839 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3889 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Veg not raw &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 698 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6122 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 376 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7196 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Sum &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1248 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9330 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1416 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11994 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

### Can we get **more information** from this contingency table? How?

--
### Yes! we can visualize their relationships!


---
class: middle 

### Step 1 - convert the frequency cell to proportions

&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Matrix X. Observed Cell Proportions&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Others &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Home &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; School_work &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; r: row masses &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Brown Bread &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0079 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0511 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0168 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0758 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Fruit &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0379 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.2160 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0700 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.3240 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Veg not raw &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0582 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.5100 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0313 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.6000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; c: col masses &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.1040 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.7780 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.1180 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.0000 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

???
- Row masses: `\(\mathbf{r} = \mathbf{X1}\)` 


```r
r &lt;- Xp %*% matrix(c(1, 1, 1), nrow = 3)
```

- Column masses: `\(\mathbf{c} = \mathbf{X}^T\mathbf{1}\)`


```r
c &lt;- t(Xp)  %*% matrix(c(1, 1, 1), nrow = 3)
```


- On average (77.8%) most of the healthy foods are eaten at home

---
class: middle 
### Step 2 - The deviation (residuals) of each cell in matrix X from its expected value

`$$\text{Deviation} = \mathbf{X} - \mathbf{rc}^T$$`

&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Deviations from Expected&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Others &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Home &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; School_work &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Sum &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Brown Bread &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.00003 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.00785 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.00781 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.00000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Fruit &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.00420 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.03587 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.03167 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.00000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Veg not raw &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.00423 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.04371 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.03948 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.00000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Sum &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.00000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.00000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.00000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.00000 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

???
Big positive (negative) numbers means a strong positive (negative) relationship.


The residuals quantify the difference between the observed data and the data we would expect under the assumption that there is no relationship between the row and column categories of the table.

---
class: middle

### Step 3 - Standardise the residual for fair comparison (Z score)

$$
\mathbf{Z}  = \mathbf{D}_r^{-\frac{1}{2}} \times \text{Deviation} \times \mathbf{D}_c^{-\frac{1}{2}}
$$



&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Standardised Residuals Table&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Others &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Home &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; School_work &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Brown Bread &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.00039 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.03231 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.08258 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Fruit &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.02285 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.07142 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.16188 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Veg not raw &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.01694 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.06399 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.14835 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


???
These standardized residuals are z-scores.  This means that values of more than 1.96, or less than -1.96, are significant at the 0.05 level. For binary variables, their standard deviation is the square root of their expected values. 


---
class: middle

### Step 4 - Single Value Decomposition

$$
\mathbf{Z} = \mathbf{UD}_\lambda \mathbf{V}^T
$$

Where, 

- `\(\mathbf{Z}\)`: the standardised deviation matrix; 
- `\(\mathbf{U}\)`: the left singular vectors of `\(\mathbf{Z}\)` &lt;br&gt; (principal axes of food groups space **for projection of locations**); 
- `\(\mathbf{D}_\lambda\)`: singular values matrix;
- `\(\mathbf{V}^T\)`: right singular vectors of `\(\mathbf{Z}\)`&lt;br&gt; (principal axes of location space **for projection of food groups**).

---
class: middle

### Recall that in principle component analysis (PCA)  - Spectral decomposition

$$
\mathbf{S} = \mathbf{P}\Lambda\mathbf{P}^T
$$

### It is also easy to prove that 

$$
\mathbf{D}_\lambda^2 = \Lambda
$$

???

- S is the variance covariance matrhx 
- Lambda is the diagonal eigenvalue matrix 
- P is orthogonal projection matrix with new coordinates for the rotated new variables

---
class: middle
### Step 4 - Single Value Decomposition

.small[
$$
`\begin{aligned}
\mathbf{Z}  &amp; = \mathbf{UD}_\lambda \mathbf{V}^T \\ 
\mathbf{Z}  &amp; = \left[\begin{matrix}
0.00039&amp;-0.032&amp;0.083\\
0.02285&amp;-0.071&amp;0.162\\
-0.01694&amp;0.064&amp;-0.148
\end{matrix}\right] \\
= \left[\begin{matrix}
-0.34&amp;0.8980&amp;0.28\\
-0.69&amp;-0.4400&amp;0.57\\
0.63&amp;0.0043&amp;0.77
\end{matrix}\right]&amp; 
\left(\begin{matrix}
0.26&amp;0&amp;0\\
0&amp;0.01&amp;0\\
0&amp;0&amp;0
\end{matrix}\right) 
\left[\begin{matrix}
-0.10&amp;-0.94&amp;0.32\\
0.39&amp;0.26&amp;0.88\\
-0.91&amp;0.22&amp;0.34
\end{matrix}\right]\\
\end{aligned}`
$$
]

In R, simply do 


```r
svd(z)
```


---
class: middle 

### Step 5 - Calculate row profile, and column profile, centre them

.pull-left[

.small[
- Percentages of location for each food was eaten:

&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Matrix R. Row Profile&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Others &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Home &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; School_work &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Sum &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 0.1050 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.6740 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.2210 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.0000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 0.1170 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.6670 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.2160 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.0000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 0.0970 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.8510 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0523 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.0000 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


$$
`\begin{aligned}
\mathbf{R} &amp; = \mathbf{D}^{-1}_r\mathbf{X} \\
\mathbf{R} &amp;\; - \mathbf{1c}^T
\end{aligned}`
$$
]]

.pull-right[
.small[
- Percentages of food was eaten at each location:

&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Matrix C. Column Profile&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Others &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Home &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; School &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Brown Bread &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0761 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0657 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.1420 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Fruit &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.3650 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.2780 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.5930 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Veg not raw &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.5590 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.6560 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.2660 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Sum &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.0000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.0000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.0000 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
$$
`\begin{aligned}
\mathbf{C} &amp; = \mathbf{D}^{-1}_r\mathbf{X}^T \\
\mathbf{C} &amp;\; - \mathbf{1r}^T
\end{aligned}`
$$

]
]

---
class: middle 

### Step 6 - Find principal coordinates for rows and columns

.pull-left[
.small[- Project the centred row profiles (food groups) onto to principal axes of locations `\(\mathbf{V}\)`
$$ 
F = (\mathbf{R} - \mathbf{1c}^T)(\mathbf{D}_c^{-1})(\mathbf{D}_c^{\frac{1}{2}}\mathbf{V})
$$

&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Matrix F: Principal Coordinates for Rows&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Horizontal &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Vertical &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Brown Bread &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.3203 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0339 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Fruit &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.3132 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.0080 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Veg not raw &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.2097 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0001 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]]

.pull-right[
.small[
- Project the centred column prifiles (locations) onto principal axes of food groups `\(\mathbf{U}\)`

$$ 
G = (\mathbf{C} - \mathbf{1r}^T)(\mathbf{D}_r^{-1})(\mathbf{D}_r^{\frac{1}{2}}\mathbf{U})
$$

&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Matrix G: Principal Coordinates for Columns&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Horizontal &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Vertical &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Others &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.0828 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.0303 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Home &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.1147 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0031 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; School_work &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -0.6827 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0066 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


]]



---
background-image: url("./img/CA_3fg3lc.png")
background-position: 50% 50%
background-size: contain

???

- the vertical axis may be interpreted as moving from structured environments (home, school-work) to unstructured (Other - leisure, party, mobile, bus, etc.)

- The percentage label for each axis is a measure of how much of the total variation in the data (inertia) has been captured in that axis. 

- So 99.8% of total variation of the contingency table is explained by the horizontal axis. 

---
class: middle

### Let's look at the row (food group) profile again


.pull-left[
.small[
&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Matrix R. Row Profile&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Others &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Home &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; School_work &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Brown Bread &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.1050 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.6740 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.2210 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;font-weight: bold;color: white !important;background-color: #d95f0e !important;"&gt; Fruit &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #d95f0e !important;"&gt; 0.1170 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #d95f0e !important;"&gt; 0.6670 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #d95f0e !important;"&gt; 0.2160 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Veg not raw &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0970 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.8510 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0523 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;font-weight: bold;color: white !important;background-color: #666666 !important;"&gt; c: col masses &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"&gt; 0.1040 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"&gt; 0.7780 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"&gt; 0.1180 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]]

.pull-right[

.small[1. The origin point is the average profile of these points.
2. On average, 77.8% of these healthy food were eaten at home
3. Although 66.7% of fruit intake were recorded at home, it is lower than the average.
4. Fruit plotted away from home. 
5. Similarly, we see vegetable plotted closer to home.
]]

???
- Length of the vector from the origin to any point represents the deviation (residuals from the average)





---
background-image: url("./img/CA_3fg3lc.png")
background-position: 50% 50%
background-size: contain


---
class: middle, center
### The full contingency table of food recordings and eating locations
.small[
<div id="htmlwidget-ca52eda360b3a3419aa7" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ca52eda360b3a3419aa7">{"x":{"filter":"none","fillContainer":false,"data":[["1% milk","2% milk","Artificial Sweeteners","Bacon and ham","Beef","Beer lager","Biscuits","Brown Bread","Burgers/kebabs","Butter","Cakes & Pastries","Cheese","Chicken/turkey","Chips","Chocolate","Coated Chicken","Commercial toddlers foods","Crisps","Diet soft drinks","Dietary supplements","Eggs","Fruit","Fruit juice","HiFi cereals","Ice cream","JamsSpreads","Lamb","Liver","LoFi cereals","LowFat Spreads","Margarine","Meat pastries","Misc./Vending","Nuts and seeds","Oily fish","Oth Bread","Other meat","Other Milk Cream","Other white fish","Pasta & Rice","Polyunsatu margarine","Pork","Potatos other","Puddings","Reg soft drinks","Salad and raw veg","Sausages","Skimmed Milk","Smoothies","Spirits and liqueurs","Spreads less-fat","Sugar confectionery","Tea/Coffee/Water","Veg not raw","White Bread","White fish, shellfish","Whole Milk","Wine","WMeal Bread","Yogurt"],[0,183,4,81,59,91,105,17,27,64,88,73,95,139,105,46,0,114,265,9,57,101,56,27,35,160,13,2,35,15,45,23,278,8,3,2,10,29,14,222,13,24,65,23,333,120,59,12,2,22,81,41,382,307,179,12,48,21,19,27],[101,4318,119,953,691,92,1407,613,162,940,853,1213,1321,1290,1077,430,5,1211,3936,495,784,2595,1450,1099,362,2956,179,20,1365,352,1107,243,5905,326,143,49,121,442,343,3325,487,255,1234,266,2659,2556,561,259,55,24,1522,387,7798,6122,2718,201,1267,86,491,745],[1,41,0,117,39,108,96,29,108,47,113,139,148,363,120,155,0,98,248,2,48,79,97,3,84,90,6,1,6,5,41,34,420,25,11,4,26,112,40,198,13,30,36,28,673,339,80,1,4,77,59,102,466,258,260,21,14,24,11,17],[2,19,3,42,0,5,95,21,24,17,46,29,43,79,117,35,0,130,76,7,12,119,13,0,21,39,1,0,4,3,7,27,113,8,6,3,10,23,9,35,3,4,6,1,196,91,14,0,3,0,40,100,173,37,103,4,5,0,16,7],[1,49,0,61,14,46,127,28,23,34,68,67,56,105,147,24,0,157,170,21,15,156,44,7,41,73,4,1,9,10,32,35,210,17,5,3,10,28,16,86,7,6,11,4,296,112,27,4,3,16,36,99,407,96,145,4,20,5,14,28],[4,87,1,473,59,0,710,176,31,152,332,451,383,184,331,67,0,667,453,10,47,776,262,8,21,177,6,1,12,93,58,86,677,61,9,18,36,81,109,441,17,28,93,80,567,531,93,0,7,0,478,170,1462,333,989,37,11,2,158,192],[0,71,2,54,7,2,57,25,8,19,27,39,41,33,32,12,0,59,80,3,14,63,18,1,5,79,1,0,1,11,7,11,92,5,1,1,9,7,19,29,5,1,7,6,103,76,13,1,2,0,52,12,318,43,111,3,21,1,17,16]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Friend<\/th>\n      <th>Home<\/th>\n      <th>Leis<\/th>\n      <th>Move<\/th>\n      <th>Other<\/th>\n      <th>School<\/th>\n      <th>Work<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[4,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
]

---
class: middle

# Obectives

- To investigate/describe the association visually between food groups and locations using Correspondence Analysis (CA). 

- To investigate/describe the association visually between food groups and time slots using CA.
- Generate and test some potential hypotheses suggested by close assocations identified using CA.


---
class: middle

# Methods and strategy 

1. Randomly select 50% of the food recordings;

1. Visualize the association structure between locations and food groups; 

2. Generating hypotheses concerning these associations for further sampling and testing them use the other half of the data;

3. Use Bonferroni method to adjust for *p* values.


---
class: middle 

# Data from the NDNS RP

- NDNS RP (started from 2008): 
    - On-going cross-sectional study
    - representative of UK popluation &lt;br&gt;- about 1000/year
    - 4 consecutive days food diary
    
- 2821 teenagers &lt;br&gt; (1396 boys, 1425 girls, age between 11-18 inclusive)

- 208037 food recordings collected.



---
background-image: url("./img/Diary1.png")
background-position: 50% 50%
background-size: contain

---
background-image: url("./img/Diary2.png")
background-position: 50% 50%
background-size: contain

---
background-image: url("./img/Diary03.png")
background-position: 50% 50%
background-size: contain


---
class: middle 

# Hierarchies in the data 

1. Food recordings are nested within individuals; 
    - Within person correlation
2. Individuals are nested within 12 survey regions; 
    - The complex survey design

## Solution:
- Mixed (random) effect logistic regression models using generalised estimating equation (GEE).
    - Covariates included: &lt;br&gt;Sex, age, socio-economic class
    

???
- GEE can estimate the Odds ratio which can be interpreted as population average effect. 

- Unbiased estiamtes (even when the correlation structure is mis-specified)


---
class: middle

### Frequencies and proportions of food recordings by eating locations

.small[
<div id="htmlwidget-b7c74032cc80a0e6e45f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b7c74032cc80a0e6e45f">{"x":{"filter":"none","fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],["Home - Living Room","Home - Kitchen","Home - Dining Room","Home - Unspecified","Home - Bedroom","Friend's or Relative's house","School - Other","School - Canteen - Bought food","School - Canteen - Food from home","Home - Other","Restaurant, pub, night club","Outside - Other","Bus, car, train","School - Playground","Unspecified","Coffee shop, cafe, shop, deli, sandwich bar","Work - Other","Fast food outlet","School - Classroom","Home - Garden","Leisure Activities, shopping, tourist attractions, cinema, places of interest","Sports club, sports leisure venue","Street","Other place","Holiday Accommodation","School - Canteen - Other","Work - Canteen - Food from home","Work - Canteen - Bought food","Work - Desk","Public Hall/Function Room","Not At Home - Unspecified","Work - Canteen - Other","Community Centre/Day Centre/Drop-in","Place of Worship","Carer's home","Nursery/Kindergarten"],[47484,44989,17605,17007,14143,9001,7367,7044,5913,4526,4236,3273,3056,2752,2666,2171,2122,1728,1728,1458,1365,1077,1060,703,641,597,458,444,315,236,230,224,214,161,38,5],["22.825%","21.625%","8.462%","8.175%","6.798%","4.327%","3.541%","3.386%","2.842%","2.176%","2.036%","1.573%","1.469%","1.323%","1.282%","1.044%","1.02%","0.831%","0.831%","0.701%","0.656%","0.518%","0.51%","0.338%","0.308%","0.287%","0.22%","0.213%","0.151%","0.113%","0.111%","0.108%","0.103%","0.077%","0.018%","0.002%"],["22.825%","44.45%","52.913%","61.088%","67.886%","72.213%","75.754%","79.14%","81.982%","84.158%","86.194%","87.767%","89.236%","90.559%","91.84%","92.884%","93.904%","94.735%","95.565%","96.266%","96.922%","97.44%","97.949%","98.287%","98.595%","98.882%","99.103%","99.316%","99.467%","99.581%","99.691%","99.799%","99.902%","99.979%","99.998%","100%"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Where<\/th>\n      <th>n<\/th>\n      <th>rel.freq<\/th>\n      <th>cumprop<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
]

---
class:  left

## The healthiness of food groups

- Healthiness scoring system is based on a system from Rayner et al. 2013.

- Categorisation of this point is controversial, roughly, the lower the point, the healthier it is considered.

- Later we use tertiles to separate the foods into three groups.


&lt;br&gt;
.footnote[
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="csl-entry"&gt;
    &lt;div class="csl-left-margin"&gt;&lt;div class="csl-right-inline"&gt;M. Rayner, P. Scarborough, and A. Kaur, “Nutrient profiling and the regulation of marketing to children. Possibilities and pitfalls,” &lt;i&gt;Appetite&lt;/i&gt;, vol. 62, pp. 232–235, 2013.&lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;
]

---
class:
### Food groups and contribution to calories

.small[
<div id="htmlwidget-48a5e13a7c9ea2e7bb9a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-48a5e13a7c9ea2e7bb9a">{"x":{"filter":"none","fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60"],["Pasta & Rice","White Bread","Chips","Reg soft drinks","Biscuits","Cakes & Pastries","Crisps","Chocolate","Chicken/turkey","Misc./Vending","2% milk","Cheese","Veg not raw","LoFi cereals","Coated Chicken","Sausages","Fruit","HiFi cereals","Beef","Potatos other","Meat pastries","JamsSpreads","Spreads less-fat","Fruit juice","Brown Bread","Bacon and ham","Burgers/kebabs","Whole Milk","Butter","Yogurt","Eggs","Sugar confectionery","WMeal Bread","Ice cream","Other Milk Cream","Puddings","White fish, shellfish","Pork","Beer lager","Margarine","Other white fish","Nuts and seeds","Lamb","Other meat","Oily fish","Salad and raw veg","Polyunsatu margarine","LowFat Spreads","Spirits and liqueurs","Oth Bread","Diet soft drinks","Wine","Skimmed Milk","Smoothies","Tea/Coffee/Water","1% milk","Liver","Dietary supplements","Commercial toddlers foods","Artificial Sweeteners"],[8625,9180,4383,9650,5101,3090,4752,3855,4155,15474,9561,4049,14371,2806,1477,1627,7742,2381,1774,2946,930,7108,4530,3885,1777,3522,789,2758,2506,2073,2019,1858,1401,1129,1481,822,560,663,647,2494,1097,900,388,428,372,7600,1054,975,276,173,10471,271,579,135,21750,204,50,1108,14,241],[1.45,3.7,0.26,3.1,19.88,18.63,13.39,25.38,0.99,9.9,1,21.99,-7.03,13.42,6.71,15.5,-3.13,4.46,2.11,-1.4,15.44,15.25,23.73,2.07,0.42,15.66,14.28,2.41,24.32,4.69,3.75,13.53,2.03,15.25,9.74,9.16,3.73,4.5,1.26,19.58,0.95,5.33,6.69,19.35,5.04,-7.47,19.94,18.18,4.07,6.04,0.36,1.29,-0.47,2.81,-0.06,0.95,18.5,4.48,15.36,3.09],["4.15%","4.41%","2.11%","4.64%","2.45%","1.49%","2.28%","1.85%","2%","7.44%","4.6%","1.95%","6.91%","1.35%","0.71%","0.78%","3.72%","1.14%","0.85%","1.42%","0.45%","3.42%","2.18%","1.87%","0.85%","1.69%","0.38%","1.33%","1.2%","1%","0.97%","0.89%","0.67%","0.54%","0.71%","0.4%","0.27%","0.32%","0.31%","1.2%","0.53%","0.43%","0.19%","0.21%","0.18%","3.65%","0.51%","0.47%","0.13%","0.08%","5.03%","0.13%","0.28%","0.06%","10.45%","0.1%","0.02%","0.53%","0.01%","0.12%"],["10.51%","8.64%","5.8%","4.93%","4.07%","3.7%","3.61%","3.56%","3.36%","2.89%","2.71%","2.54%","2.31%","2.24%","2.22%","2.1%","1.88%","1.87%","1.86%","1.84%","1.72%","1.64%","1.6%","1.58%","1.57%","1.53%","1.34%","1.27%","1.22%","1.19%","1.16%","1.16%","1.16%","1.09%","1.05%","0.85%","0.72%","0.68%","0.6%","0.55%","0.48%","0.46%","0.46%","0.36%","0.35%","0.26%","0.2%","0.2%","0.16%","0.15%","0.13%","0.11%","0.11%","0.08%","0.06%","0.05%","0.04%","0.02%","0%","0%"],["10.51%","19.149%","24.945%","29.871%","33.945%","37.645%","41.254%","44.817%","48.173%","51.061%","53.767%","56.304%","58.615%","60.852%","63.073%","65.176%","67.059%","68.925%","70.786%","72.631%","74.348%","75.991%","77.589%","79.17%","80.74%","82.268%","83.612%","84.882%","86.102%","87.292%","88.457%","89.616%","90.773%","91.867%","92.913%","93.763%","94.481%","95.158%","95.761%","96.309%","96.787%","97.248%","97.706%","98.066%","98.415%","98.672%","98.876%","99.074%","99.237%","99.391%","99.522%","99.636%","99.743%","99.827%","99.888%","99.942%","99.98%","99.996%","99.999%","100%"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mfgLab<\/th>\n      <th>n<\/th>\n      <th>Hpoint<\/th>\n      <th>n.freq<\/th>\n      <th>cal.Prop<\/th>\n      <th>calcumprop<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
]

---
class: middle, center
### The full contingency table of food recordings and eating locations
.small[
<div id="htmlwidget-c566bfa85ff93bca0e4c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c566bfa85ff93bca0e4c">{"x":{"filter":"none","fillContainer":false,"data":[["1% milk","2% milk","Artificial Sweeteners","Bacon and ham","Beef","Beer lager","Biscuits","Brown Bread","Burgers/kebabs","Butter","Cakes & Pastries","Cheese","Chicken/turkey","Chips","Chocolate","Coated Chicken","Commercial toddlers foods","Crisps","Diet soft drinks","Dietary supplements","Eggs","Fruit","Fruit juice","HiFi cereals","Ice cream","JamsSpreads","Lamb","Liver","LoFi cereals","LowFat Spreads","Margarine","Meat pastries","Misc./Vending","Nuts and seeds","Oily fish","Oth Bread","Other meat","Other Milk Cream","Other white fish","Pasta & Rice","Polyunsatu margarine","Pork","Potatos other","Puddings","Reg soft drinks","Salad and raw veg","Sausages","Skimmed Milk","Smoothies","Spirits and liqueurs","Spreads less-fat","Sugar confectionery","Tea/Coffee/Water","Veg not raw","White Bread","White fish, shellfish","Whole Milk","Wine","WMeal Bread","Yogurt"],[0,183,4,81,59,91,105,17,27,64,88,73,95,139,105,46,0,114,265,9,57,101,56,27,35,160,13,2,35,15,45,23,278,8,3,2,10,29,14,222,13,24,65,23,333,120,59,12,2,22,81,41,382,307,179,12,48,21,19,27],[101,4318,119,953,691,92,1407,613,162,940,853,1213,1321,1290,1077,430,5,1211,3936,495,784,2595,1450,1099,362,2956,179,20,1365,352,1107,243,5905,326,143,49,121,442,343,3325,487,255,1234,266,2659,2556,561,259,55,24,1522,387,7798,6122,2718,201,1267,86,491,745],[1,41,0,117,39,108,96,29,108,47,113,139,148,363,120,155,0,98,248,2,48,79,97,3,84,90,6,1,6,5,41,34,420,25,11,4,26,112,40,198,13,30,36,28,673,339,80,1,4,77,59,102,466,258,260,21,14,24,11,17],[2,19,3,42,0,5,95,21,24,17,46,29,43,79,117,35,0,130,76,7,12,119,13,0,21,39,1,0,4,3,7,27,113,8,6,3,10,23,9,35,3,4,6,1,196,91,14,0,3,0,40,100,173,37,103,4,5,0,16,7],[1,49,0,61,14,46,127,28,23,34,68,67,56,105,147,24,0,157,170,21,15,156,44,7,41,73,4,1,9,10,32,35,210,17,5,3,10,28,16,86,7,6,11,4,296,112,27,4,3,16,36,99,407,96,145,4,20,5,14,28],[4,87,1,473,59,0,710,176,31,152,332,451,383,184,331,67,0,667,453,10,47,776,262,8,21,177,6,1,12,93,58,86,677,61,9,18,36,81,109,441,17,28,93,80,567,531,93,0,7,0,478,170,1462,333,989,37,11,2,158,192],[0,71,2,54,7,2,57,25,8,19,27,39,41,33,32,12,0,59,80,3,14,63,18,1,5,79,1,0,1,11,7,11,92,5,1,1,9,7,19,29,5,1,7,6,103,76,13,1,2,0,52,12,318,43,111,3,21,1,17,16]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Friend<\/th>\n      <th>Home<\/th>\n      <th>Leis<\/th>\n      <th>Move<\/th>\n      <th>Other<\/th>\n      <th>School<\/th>\n      <th>Work<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[4,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
]



---
background-image: url("./img/CA60fg7lc_not.png")
background-position: 50% 50%
background-size: contain


---
background-image: url("./img/CA60fg7lc_big.png")
background-position: 50% 50%
background-size: contain

???
- This plot figure captured 88.8% total variation of the contingency table.

- Horizontally, Home contrasts with all the others; 

- Vertically, school and work locations are different from the other locations; 

- School/home are hugly different from Leisure locations (clubs and cafe); home and move are also far away from similar.


---
class: inverse, center, middle

# Stratified CA biplots




---
background-image: url("./img/F1st20_loc.png")
background-position: 50% 50%
background-size: contain

???

- 90% of total variation were explained in this figure 

- Chicken, fish, brown bread, fruit, white meal bread are more likely to be consumed at school and work

- Pasta, rice, milk, are more likely to be consumed at home.

- Beer, Wine, Chips are associated when the teenagers are with friends, leisure locations.

---
background-image: url("./img/F2nd20_loc.png")
background-position: 50% 50%
background-size: contain

???

- Regular sweet soft drinks are closely associated with Friends, on the move. 

- Spirits and liqueurs are far awary from the other food here and closer to leisure locations. 

---
background-image: url("./img/F3rd20_loc.png")
background-position: 50% 50%
background-size: contain

???

- Cheese, crisps, biscuits are associated with school and work.

- Sugar, candy, are associated when teenagers are on the move.

- Meat pastries and chocolate are shown together and associated with Friends.


---
class: 
## To simplify testing Location definition collapsed:

.pull-left[
.small[
&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Location &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Location &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Home &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Home &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; School &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; School-Work &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Work &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; School-Work &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Friends/Carers/Relatives &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Other &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Mobile: bus, car, street, etc &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Other &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Leisure: café, club, church, etc &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Other &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Other &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Other &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]
]


.pull-right[
.small[
- Leisure, on the move, Friends, and others are usually close to each other and on the same quadrant (象限)

- Same with school and work. 

- So the interest become to look for those food that was associated with locations away from home/school
]]

---
class: middle

## Hypotheses:


1. Chocoloate and meat pastries apear to be highly associated in their location being consumed.

2. Sweetened soft drinks, chips, fruit, chocolate, and meat pastries were more likely to be consumed when a teenager is away from home, or away from school.


---
class: middle
## Correlation between chocolate and meat pastries

- The correlation between two profile vectors, `\(\mathbf{f1, f2}\)`

- can be proved to be equivalent to the cosine of the angle between the vectors: `$$\cos\theta = \frac{\mathbf{f1  f2}}{|f1||f2|}$$`

- We applied bootstrapping approach (10000 subsamples with replacement) and run CA on each sample, and calculate `\(\cos\theta\)` for each sample

---
class: middle, center
### Bootstrap distribution of the correlation for chocolate and meat pastries
![Bootstrap](img/Screen Shot 2019-09-11 at 19.19.45.png)


---
class: middle

## Location profile for chocolate and meat pastries

.small[
&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Friend &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Home &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Leis &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Move &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Other &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; School &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Work &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Total &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Chocolate &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 105 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1077 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 120 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 117 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 147 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 331 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 32 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1929 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 5.4% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 55.8% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 6.2% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 6.1% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 7.6% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 17.2% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.7% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Meat pastries &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 23 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 243 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 34 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 27 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 35 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 86 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 459 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 5.0% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 52.9% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 7.4% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 5.9% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 7.6% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 18.7% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.4% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Row mass &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 4.5% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 63.4% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 5.5% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3.0% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 4.2% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 17.4% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.0% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]


---
class:middle

### Soft-drinks, chips, chocolate, meat pastries and fruit at locations away from home/school


.small[
&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; H0 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; OR vs Home &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; 99% CI &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; OR vs School-work &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; 99% CI &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Sweetened soft drinks &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; (2.3, 2.5) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.30 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; (1.7, 3.1) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Chips &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; (2.2, 3.6) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.40 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; (2.1, 5.3) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Chocolates &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; (1.8, 3.4) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.80 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; (1.2, 2.8) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Meat pastries &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; (1.5, 5.0) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.30 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; (0.6, 3.0) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Fruit &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; (0.49, 0.98) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.44 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; (0.29, 0.67) &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]


---
class:

# Conclusion

- Sweetened soft drinks, chips, and chocolates are more likely to be consumed when a teenager finds himself/herself at locations other than Home or School.

- Meat pastries are more likely to be consumed outside of Home (because school and other locations are equally likely)

- Odds of eating fruit at other locations are significantly lower than at home, and at school.

---
class: middle

## Correlation between chocolate and meat pastries

- Chocolate and meat pastries have location profiles which are strongly correlated.

- Both conveient foods to carry and eat.

- Both available at low prices (&lt;£2).

---
class: middle

## Why These are important?

- Large proportion of food consumed at other locations is packaged and sold, rather than cooked meals at home or school. 

- Policymakers may need to legislate and regulate about what is sold, how the price should be, how they should be packaged and promoted for teenagers.


---
class: middle, center, inverse

# Food group consumption and time slots

---
class: middle

## Objectives

- To investigate and describe the relationshipt between **food** eaten by British adults, **time slots** and **diabetes status**.


---
background-image: url("./img/Diary1.png")
background-position: 50% 50%
background-size: contain

---
background-image: url("./img/Diary2.png")
background-position: 50% 50%
background-size: contain

---
background-image: url("./img/Diary03.png")
background-position: 50% 50%
background-size: contain


---
class: middle 

## Methods and strategies

- Correspodence analysis (CA)
    - Biplots stratified by diabetes status

- Mixed effect logistic regression using generalized estimating equation (GEE). 

- Generate hypotheses from half of the food recordings, and test using the other half.

- Time slots defined:  6-9 am, 9-12 noon, 12-2 pm, 2-5 pm, 5-8 pm, 8-10 pm and 10 pm-6 am.

---
class: middle 

## Definition of diabetes

&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Diabetes Status &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Self-reported &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Glucose (mmol/L) &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; HbA1c (%) &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; No diabetes &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &amp;lt; 6.1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &amp;lt; 6.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2626 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Pre-diabetes &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 6.1 ~ 6.99 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -- &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 133 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Undiagnosed &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &amp;gt;= 7.00 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &amp;gt;= 6.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 99 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Diagnosed &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Yes &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -- &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; -- &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 227 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Missing &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3717 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
class: middle 

## Summary statistics 

6802 adults (age &gt;= 19 years), 2810 men and 3992 women from NDNS RP data (2008-2018). 749,026 recordings of food group entries.

.small[
&lt;table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; MealTimeSlot &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; rel.freq &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; cum.freq &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; 6am to 8:59am &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 107144 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 14.304% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 14.304% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; 9am to 11:59am &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 110614 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 14.768% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 29.072% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; 12 noon to 1:59pm &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 138183 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 18.448% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 47.521% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; 2pm to 4:59pm &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 94606 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 12.631% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 60.151% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; 5pm to 7:59pm &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 180498 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 24.098% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 84.249% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; 8pm to 9:59pm &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 81716 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10.91% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 95.158% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; 10pm to 5:59am &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 36265 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 4.842% &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 100% &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]


---
class: middle
### Food groups and contribution to calories


.small[
<div id="htmlwidget-ab71f3ce3e1aec891c0c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ab71f3ce3e1aec891c0c">{"x":{"filter":"none","fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60"],["Pasta & Rice","White Bread","Chips","Cakes & Pastries","Veg not raw","Biscuits","Fruit","Misc./Vending","Chicken/turkey","Cheese","Beer lager","2% milk","Potatos other","JamsSpreads","Beef","HiFi cereals","WMeal Bread","Chocolate","Wine","Brown Bread","Butter","Eggs","Reg soft drinks","Spreads less-fat","Crisps","Sausages","Meat pastries","Bacon and ham","Yogurt","LoFi cereals","Nuts and seeds","Oily fish","Whole Milk","White fish, shellfish","Puddings","Other Milk Cream","Pork","Fruit juice","Margarine","Coated Chicken","Other white fish","Lamb","Burgers/kebabs","Ice cream","Salad and raw veg","Spirits and liqueurs","Other meat","Tea/Coffee/Water","Skimmed Milk","Sugar confectionery","Oth Bread","LowFat Spreads","Polyunsatu margarine","Liver","Dietary supplements","Diet soft drinks","1% milk","Smoothies","Artificial Sweeteners","Commercial toddlers foods"],[18353,18434,6749,7806,51317,13200,33903,48597,8863,10983,8199,57611,10113,37960,4987,8215,7193,6495,6967,6183,10203,7554,11387,12620,5664,3025,1979,8467,6776,4303,6259,2610,13628,1597,2291,6605,1832,6960,8742,1170,3703,1251,939,1816,33263,2698,1571,152108,9683,1820,932,3654,3179,454,13016,14155,1263,137,7518,66],[-0.3,3.61,0.09,17.3,-7.03,18.3,-2.81,9.49,0.53,21.54,0.99,1.02,-1.49,14.69,2.34,2.78,2.08,24.9,1.33,1.11,24.35,3.7,3.31,23.45,12.98,15.32,14.77,15.48,3.22,11.62,4.37,6.21,2.24,3.99,8.4,11.58,3.88,1.79,19.59,6.43,1.28,6.42,14.56,15.43,-7.03,4.03,17.03,-0.24,-0.54,14.5,4.96,18.05,19.96,13.57,5.16,0.32,0.97,2.93,1.6,18.55],["2.45%","2.46%","0.9%","1.04%","6.85%","1.76%","4.53%","6.49%","1.18%","1.47%","1.09%","7.69%","1.35%","5.07%","0.67%","1.1%","0.96%","0.87%","0.93%","0.83%","1.36%","1.01%","1.52%","1.68%","0.76%","0.4%","0.26%","1.13%","0.9%","0.57%","0.84%","0.35%","1.82%","0.21%","0.31%","0.88%","0.24%","0.93%","1.17%","0.16%","0.49%","0.17%","0.13%","0.24%","4.44%","0.36%","0.21%","20.31%","1.29%","0.24%","0.12%","0.49%","0.42%","0.06%","1.74%","1.89%","0.17%","0.02%","1%","0.01%"],["7.36%","6.8%","3.95%","3.59%","3.49%","3.49%","3.44%","3.44%","3.39%","3.13%","3.11%","2.73%","2.71%","2.55%","2.36%","2.25%","2.24%","2.19%","2.15%","2.12%","2.02%","2.02%","1.97%","1.78%","1.75%","1.62%","1.56%","1.55%","1.4%","1.17%","1.17%","1.15%","1.11%","1.05%","0.96%","0.91%","0.88%","0.88%","0.86%","0.75%","0.74%","0.72%","0.69%","0.65%","0.62%","0.6%","0.57%","0.37%","0.35%","0.34%","0.31%","0.28%","0.27%","0.14%","0.09%","0.07%","0.06%","0.04%","0.01%","0%"],["7.362%","14.166%","18.116%","21.701%","25.193%","28.678%","32.12%","35.555%","38.947%","42.074%","45.185%","47.916%","50.623%","53.171%","55.528%","57.777%","60.022%","62.215%","64.369%","66.484%","68.509%","70.532%","72.503%","74.283%","76.035%","77.659%","79.22%","80.769%","82.164%","83.338%","84.512%","85.666%","86.778%","87.824%","88.788%","89.698%","90.579%","91.459%","92.319%","93.073%","93.818%","94.535%","95.224%","95.873%","96.495%","97.096%","97.665%","98.033%","98.387%","98.732%","99.045%","99.327%","99.593%","99.734%","99.828%","99.897%","99.955%","99.99%","99.996%","100%"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mfgLab<\/th>\n      <th>n<\/th>\n      <th>Hpoint<\/th>\n      <th>n.freq<\/th>\n      <th>cal.Prop<\/th>\n      <th>calcumprop<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
]


---
class: middle, center
### The full contingency table of food recordings and time slots

.tiny[
<div id="htmlwidget-7e7c263bc79457c6eda8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7e7c263bc79457c6eda8">{"x":{"filter":"none","fillContainer":false,"data":[["1% milk","2% milk","Artificial Sweeteners","Bacon and ham","Beef","Beer lager","Biscuits","Brown Bread","Burgers/kebabs","Butter","Cakes & Pastries","Cheese","Chicken/turkey","Chips","Chocolate","Coated Chicken","Commercial toddlers foods","Crisps","Diet soft drinks","Dietary supplements","Eggs","Fruit","Fruit juice","HiFi cereals","Ice cream","JamsSpreads","Lamb","Liver","LoFi cereals","LowFat Spreads","Margarine","Meat pastries","Misc./Vending","Nuts and seeds","Oily fish","Oth Bread","Other meat","Other Milk Cream","Other white fish","Pasta & Rice","Polyunsatu margarine","Pork","Potatos other","Puddings","Reg soft drinks","Salad and raw veg","Sausages","Skimmed Milk","Smoothies","Spirits and liqueurs","Spreads less-fat","Sugar confectionery","Tea/Coffee/Water","Veg not raw","White Bread","White fish, shellfish","Whole Milk","Wine","WMeal Bread","Yogurt"],[189,7513,920,209,3,11,417,540,0,812,182,131,19,19,52,0,3,11,361,4685,424,2631,992,2534,0,4639,1,10,1212,330,137,11,877,645,26,76,40,610,8,694,51,4,13,13,295,165,70,1416,12,3,983,40,14297,203,1195,1,1654,3,683,524],[137,6844,832,757,28,34,1173,567,14,876,597,381,96,96,349,6,3,270,679,1244,810,3012,592,1255,8,4477,3,14,704,323,317,68,1608,528,47,79,86,535,58,545,95,15,44,39,551,620,266,1047,14,9,1262,125,16103,669,1775,6,1584,11,674,435],[50,3262,467,1707,435,253,1130,1073,112,1243,778,1916,1011,624,470,115,15,875,1167,137,915,3700,536,102,93,2283,113,72,80,533,802,308,5795,466,414,162,257,446,604,1574,264,169,982,246,1052,5822,301,509,20,31,1776,113,10587,5299,2748,148,792,184,1178,803],[66,3986,591,453,254,440,1405,287,81,548,891,656,571,442,728,91,6,520,1076,74,378,2341,337,41,143,2504,72,20,37,151,448,140,2720,401,147,51,100,431,194,925,143,102,536,147,969,1878,151,626,10,71,549,243,11780,2559,908,72,851,178,296,326],[79,3124,410,906,1462,1014,813,363,219,1085,857,1563,2039,1727,522,300,11,443,1916,121,960,2937,650,43,399,2518,296,76,40,309,1946,349,9386,498,572,70,207,780,673,3934,753,475,2987,498,1396,6086,578,510,4,297,1049,164,10414,13693,1643,448,919,1317,474,808],[48,2530,337,213,306,1467,1013,178,49,385,465,644,544,376,834,64,4,501,1199,121,262,1793,294,69,210,1673,99,23,48,101,663,104,2990,394,151,19,78,386,244,1259,228,107,434,155,920,1814,111,436,4,518,424,165,7327,3022,660,85,645,1376,185,372],[35,1533,219,57,38,826,614,87,12,145,177,182,103,83,303,20,0,228,674,179,56,518,134,95,44,912,16,2,75,45,91,29,859,153,17,13,18,139,39,270,39,7,36,53,527,301,15,309,1,403,190,82,5544,314,280,5,442,376,92,114]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>6am to 8:59am<\/th>\n      <th>9am to 11:59am<\/th>\n      <th>12 noon to 1:59pm<\/th>\n      <th>2pm to 4:59pm<\/th>\n      <th>5pm to 7:59pm<\/th>\n      <th>8pm to 9:59pm<\/th>\n      <th>10pm to 5:59am<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
]




---
class: middle, center, inverse

# CA biplots in total sample

---
background-image: url("./img/F60T7.png")
background-position: 50% 50%
background-size: contain

???

- It seems that later time in the day (8 pm- 10pm-) are shown on the upper side of the plot. 

- Morning time people are having breakfast foods (cereals/milk)

- Chocolate, Bear, Spirits, sugar candy, sweetened soft drinks are clouded around later times. 


---
background-image: url("./img/F201T7.png")
background-position: 50% 50%
background-size: contain

???

- it is clearer that late time slots (8pm - 10pm, 10pm - 6am) are different from the earlier hours in stratified figures by food groups (for better visualisation)



---
background-image: url("./img/F202T7.png")
background-position: 50% 50%
background-size: contain



---
background-image: url("./img/F203T7.png")
background-position: 50% 50%
background-size: contain



---
class: middle, center, inverse

# Food group consumption and time slots &lt;br&gt; stratified by DM status


---
background-image: url("./img/F60T7_nonDM.png")
background-position: 50% 50%
background-size: contain

???

- IN non-diabetes, sugar, beer, wine, crisps, sweetened soft drink, biscuits are more associated with night period time slots. 


---
background-image: url("./img/F60T7_DM.png")
background-position: 50% 50%
background-size: contain

???

- For Diagnosed DM patients (self-reported), beer, spirits, chocolate, biscuits, regular sweetened soft drinks are apear close to time after 8 pm. 


---
background-image: url("./img/F60T7_UndiagDM.png")
background-position: 50% 50%
background-size: contain

???

- Among undiagnosed DM patients, sugar, chocolate, Beer, regular soft drinks, wine, ice cream, biscuits, Puddings seems to apear to shown in later time slots. 


---
background-image: url("./img/F60T7_PreDM.png")
background-position: 50% 50%
background-size: contain


---
class:center

##### OR for food groups eaten at night (8pm - ) vs. earlier time, among total and according to DM status




.small[
<div id="htmlwidget-068acdbf84ef6faef040" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-068acdbf84ef6faef040">{"x":{"filter":"none","fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9"],["Pudding","Sweetened Soft drink","Sugar Confectionery","Chocolate","Spirit","Beer","Ice cream","Biscuit","Crisp"],["1.38 (1.03, 1.86)","1.74 (1.47, 2.06)","1.92 (1.38, 2.69)","3.19 (2.69. 3.79)","11.13 (8.37, 14.80)","7.19 (5.87, 8.82)","2.38 (1.79, 3.15)","1.91 (1.67, 2.16)","1.55 (1.27, 1.88)"],["1.50 (1.10, 2.07)","1.72 (1.43, 2.06)","1.63 (1.14, 2.32)","3.10 (2.57, 3.73)","10.86 (8.01, 14.73)","7.49 (6.02, 9.34)","2.45 (1.82, 3.31)","1.78 (1.55, 2.03)","1.56 (1.27, 1.92)"],["0.89 (0.16, 4.87)","1.87 (0.97, 3.57)","2.10 (0.52, 8.46)","4.07 (2.02, 8.19)","8.48 (2.26, 31.79)","4.05 (2.00, 8.20)","3.32 (0.75, 14.62)","3.51 (2.16, 5.71)","1.95 (0.79, 4.78)"],["1.81 (0.41, 7.98)","2.72 (1.44, 5.14)","13.07 (4.59, 37.24)","2.52 (0.95, 6.66)","7.51 (1.99, 5.21)","7.87 (3.51, 17.63)","0.98 (0.14, 7.00)","2.75 (1.35, 5.59)","1.37 (0.37, 5.12)"],["0.58 (0.14, 2.43)","1.38 (0.65, 2.96)","5.10 (2.15, 12.09)","5.13 (2.55, 10.30)","36.8 (7.36, 183.66)","6.32 (2.29, 17.47)","1.65 (0.54, 5.07)","2.44 (1.54, 3.88)","1.16 (0.49, 2.75)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>H0<\/th>\n      <th>Overall<\/th>\n      <th>Non-DM<\/th>\n      <th>Pre-DM<\/th>\n      <th>Undiag-DM<\/th>\n      <th>DM<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":3,"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}],"lengthMenu":[3,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
]


---
class: middle 

# Discussion 

- Assessing the relationships between less healthy foods and timing of eating is a first step towards identifying specific public health targets for behaviour change/modification.

- Potentially alcoholic/sweetened beverages and foods rich in added sugars and saturated fats. 

&lt;!-- - The greater odds of eating puddings in the evening might partly explain the undiagnosed/prediabetic state.  --&gt;

- The survey cross-sectional nature warrants further investigations by longitudinal cohort studies.



---
background-image: url("./img/CAbook.jpg")
background-position: 50% 50%
background-size: contain

---
class: left
background-image: url("./img/Screen Shot 2019-09-13 at 22.40.12.png")
background-position: 50% 50%
background-size: contain

### The Cholera map

.footnote[
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="csl-entry"&gt;
&lt;div class="csl-right-inline"&gt;N. Shiode, et. al. International journal of health geographics 2015.&lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;
]


---
class: inverse
background-image: url("./img/Screen Shot 2019-09-13 at 22.29.43.png")
background-position: 50% 50%
background-size: contain


---
class: left, bottom, inverse
background-image: url("./img/IMG_0258.png")
background-position: 50% 50%
background-size: contain

# Thanks
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"highlightSpans": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function(time) {
  var d2 = function(number) {
    return ('0' + number).slice(-2); // left-pad 0 to minutes/seconds
  },

  time_format = function(total) {
    var secs = Math.abs(total) / 1000;
    var h = Math.floor(secs / 3600);
    var m = Math.floor(secs % 3600 / 60);
    var s = Math.round(secs % 60);
    var res = d2(m) + ':' + d2(s);
    if (h > 0) res = h + ':' + res;
    return res;  // [hh:]mm:ss
  },

  slide_number_div = function(i) {
    return document.getElementsByClassName('remark-slide-number').item(i);
  },

  current_page_number = function(i) {
    return slide_number_div(i).firstChild.textContent;  // text "i / N"
  };

  var timer = document.createElement('span'); timer.id = 'slide-time-left';
  var time_left = time, k = slideshow.getCurrentSlideIndex(),
      last_page_number = current_page_number(k);

  setInterval(function() {
    time_left = time_left - 1000;
    timer.innerHTML = ' ' + time_format(time_left);
    if (time_left < 0) timer.style.color = 'red';
  }, 1000);

  slide_number_div(k).appendChild(timer);

  slideshow.on('showSlide', function(slide) {
    var i = slide.getSlideIndex(), n = current_page_number(i);
    // reset timer when a new slide is shown and the page number is changed
    if (last_page_number !== n) {
      time_left = time; last_page_number = n;
      timer.innerHTML = ' ' + time_format(time); timer.style.color = null;
    }
    slide_number_div(i).appendChild(timer);
  });
})(60000);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
